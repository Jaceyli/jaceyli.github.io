<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="baidu-site-verification" content="E91H9LxOVM" />
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.png">
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <title>
        
          Spark I - Jingxuan&#39;s blog
        
    </title>

    <link rel="canonical" href="https://jingxuan.li/2018/05/05/COMP9313-Week-6-Spark-I/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS --> 
    <link rel="stylesheet" href="/css/beantech.min.css">
    
    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css">

    <link rel="stylesheet" href="/css/widget.css">

    <link rel="stylesheet" href="/css/rocket.css">

    <link rel="stylesheet" href="/css/signature.css">

    <link rel="stylesheet" href="/css/toc.css">

    <!-- Custom Fonts -->
    <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116294246-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-116294246-1');
    </script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">
	<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        
            background-image: url('bg.jpg')
            /*post*/
        
    }
    
</style>

<header class="intro-header" >
    <!-- Signature -->
    <div id="signature">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                
                    <div class="post-heading">
                        <div class="tags">
                            
                              <a class="tag" href="/tags/#COMP9313" title="COMP9313">COMP9313</a>
                            
                              <a class="tag" href="/tags/#Spark" title="Spark">Spark</a>
                            
                              <a class="tag" href="/tags/#Scala" title="Scala">Scala</a>
                            
                        </div>
                        <h1>Spark I</h1>
                        <h2 class="subheading">COMP9313 Week 6 @18S1 UNSW</h2>
                        <span class="meta">
                            Posted by Jingxuan on
                            2018-05-05
                        </span>
                    </div>
                


                </div>
            </div>
        </div>
    </div>
</header>

	
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Jingxuan&#39;s Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    

                        
                    

                        
                        <li>
                            <a href="/archive/">Archives</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/about/">About</a>
                        </li>
                        
                    

                        
                        <li>
                            <a href="/tags/">Tags</a>
                        </li>
                        
                    
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Main Content -->
    <!-- Modify by Yu-Hsuan Yen -->

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                <blockquote>
<p>本周主要内容：</p>
<ul>
<li>Spark Introduction</li>
<li>Scala Introduction</li>
<li>RDD Introduction</li>
<li>Spark programming model</li>
</ul>
</blockquote>
<h1 id="spark-introduction">Spark Introduction</h1>
<hr>
<h2 id="why-spark">Why Spark?</h2>
<ul>
<li>
<p>MapReduce greatly simplified big data analysis on large, unreliable clusters. It is great at one-pass computation.</p>
</li>
<li>
<p>But as soon as it got popular, users wanted more:</p>
<ul>
<li>More <strong>complex</strong>, multi-pass analytics (e.g. ML, graph)</li>
<li>More <strong>interactive</strong> ad-hoc(点对点) queries</li>
<li>More <strong>real-time</strong> stream processing<br>
All 3 need faster <strong>data sharing across parallel jobs</strong></li>
</ul>
</li>
<li>
<p>Goals of Spark: <strong>Keep more data in-memory to improve the performance!</strong></p>
</li>
<li>
<p>Extend the MapReduce model to better support two common classes of analytics apps:</p>
<ul>
<li>Iterative algorithms (machine learning, graphs)</li>
<li>Interactive data mining</li>
</ul>
</li>
</ul>
<h2 id="what-is-spark">What is Spark?</h2>
<ul>
<li>
<p>Open-source engine for large-scale data processing</p>
<ul>
<li>Supports generalized dataflows</li>
<li>Written in Scala, with bindings in Java and Python</li>
</ul>
</li>
<li>
<p>Brief History<br>
<img src="3.png" alt=""></p>
</li>
<li>
<p>Improves efficiency through:</p>
<ul>
<li>In-memory computing primitives</li>
<li>General computation graphs<br>
<strong>Up to 100 times faster(10 * 10 on disk)</strong></li>
</ul>
</li>
<li>
<p>Improves usability through:</p>
<ul>
<li>Rich APIs in Scala, Java, Python</li>
<li>Interactive shell<br>
<strong>Often 5 times less code</strong></li>
</ul>
</li>
</ul>
<p><img src="4.png" alt=""></p>
<ul>
<li>Spark SQL (SQL on Spark)</li>
<li>Spark Streaming (stream processing)</li>
<li>GraphX (graph processing)</li>
<li>MLlib (machine learning library)</li>
</ul>
<h2 id="data-sources">Data Sources</h2>
<ul>
<li>Local Files</li>
<li>S3</li>
<li>Hadoop Distributed Filesystem</li>
<li>HBase, Cassandra, etc.</li>
</ul>
<h2 id="spark-workflow">Spark Workflow</h2>
<ul>
<li>A Spark program first creates a SparkContext object
<ul>
<li>Tells Spark how and where to access a cluster</li>
<li>Connect to several types of cluster managers (e.g., YARN, Mesos, or its own manager)</li>
</ul>
</li>
<li>Cluster manager:
<ul>
<li>Allocate resources acrossapplications</li>
</ul>
</li>
<li>Spark executor:
<ul>
<li>Run computations</li>
<li>Access data storage<br>
<img src="5.png" alt=""></li>
</ul>
</li>
</ul>
<h2 id="worker-nodes-and-executors">Worker Nodes and Executors</h2>
<ul>
<li>Worker nodes are machines that run executors
<ul>
<li>Host one or multiple Workers</li>
<li>One JVM (1 process) per Worker</li>
<li>Each Worker can spawn one or more Executors</li>
</ul>
</li>
<li>Executors run tasks
<ul>
<li>Run in child JVM (1 process)</li>
<li>Execute one or more task using threads in a ThreadPool</li>
</ul>
</li>
</ul>
<p><img src="6.png" alt=""></p>
<hr>
<ul>
<li>Recommend a Clear Explanation for Spark</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/x8xXXqvhZq8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
<br>
<p>From the course above, it shows main differences between MapReduce and Spark</p>
<ul>
<li>
<p>MapReduce<br>
<img src="1.png" alt=""></p>
</li>
<li>
<p>Spark<br>
<img src="2.png" alt=""></p>
<ul>
<li>Red: required interaction with disk ( I/O cost)</li>
<li>Yellow: required spinning up and spinning down containers across the cluster</li>
</ul>
</li>
</ul>
<h1 id="scala-introduction">Scala Introduction</h1>
<hr>
<ul>
<li>Scala(<strong>Sca</strong>lable <strong>la</strong>nguage)
<ul>
<li>Scala is a <strong>general-purpose</strong> programming language designed to express common programming patterns in a concise, elegant, and type-safe way</li>
<li>Scala supports <strong>both Object Oriented Programming and Functional Programming</strong></li>
<li>Scala is Practical
<ul>
<li>Can be used as drop-in replacement for Java, Mixed Scala/Java projects</li>
<li>Use existing Java libraries</li>
<li>Use existing Java tools (Ant, Maven, JUnit, etc…)</li>
<li>Decent IDE Support (NetBeans, IntelliJ, Eclipse)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="scala-basic-syntax">Scala Basic Syntax</h2>
<ul>
<li>When considering a Scala program, it can be defined as <strong>a collection of objects</strong> that communicate via invoking each other’s methods.</li>
<li><strong>Object</strong> − same as in Java</li>
<li><strong>Class</strong> − same as in Java</li>
<li><strong>Methods</strong> − same as in Java</li>
<li><strong>Fields</strong> − Each object has its unique set of instant variables, which are called fields. An object’s state is created by the values assigned to these fields.</li>
<li><strong>Traits</strong> − Like Java Interface. A trait encapsulates method and field definitions, which can then be reused by mixing them into classes.</li>
<li><strong>Closure</strong> − A closure is a function, whose return value depends on the value of one or more variables declared outside this function.<br>
closure = function + enviroment</li>
</ul>
<br>
<ul>
<li>Scala is Statically Typed
<ul>
<li>You don’t have to specify a type in most cases</li>
</ul>
</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> sum = <span class="number">1</span> + <span class="number">2</span> + <span class="number">3</span></span><br><span class="line"><span class="keyword">val</span> nums = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">val</span> map = <span class="type">Map</span>(<span class="string">"abc"</span> -&gt; <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> sum: <span class="type">Int</span> = <span class="number">1</span> + <span class="number">2</span> + <span class="number">3</span></span><br><span class="line"><span class="keyword">val</span> nums: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>) </span><br><span class="line"><span class="keyword">val</span> map: <span class="type">Map</span>[<span class="type">String</span>, <span class="type">List</span>[<span class="type">Int</span>]] = ...</span><br></pre></td></tr></table></figure>
<ul>
<li>Scala is High level<br>
E.g., Java vs. scala check string uppercase</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Java – Check if string has uppercase character</span></span><br><span class="line"><span class="keyword">boolean</span> hasUpperCase = <span class="keyword">false</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; name.length(); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span>(Character.isUpperCase(name.charAt(i))) &#123; </span><br><span class="line">        hasUpperCase = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">break</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Scala</span></span><br><span class="line"><span class="keyword">val</span> hasUpperCase = name.exists(_.isUpper)</span><br></pre></td></tr></table></figure>
<ul>
<li>Scala is Concise</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, Int age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name; </span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123; </span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123; </span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//scala</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">var name: <span class="type">String</span>, private var _age: <span class="type">Int</span></span>) </span>&#123; </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age</span> </span>= _age <span class="comment">// Getter for age</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">age_=</span></span>(newAge:<span class="type">Int</span>) &#123; <span class="comment">// Setter for age</span></span><br><span class="line">        println(<span class="string">"Changing age to: "</span>+newAge)</span><br><span class="line">        _age = newAge</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Var</strong>iables and <strong>Val</strong>ues</li>
</ul>
<ol>
<li>Variables: values stored can be changed</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = <span class="string">"foo"</span></span><br><span class="line">foo = <span class="string">"bar"</span> <span class="comment">// okay</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>Values: immutable variable 不可改变的</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> foo = <span class="string">"foo"</span></span><br><span class="line">foo = <span class="string">"bar"</span> <span class="comment">// nope</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Scala is Pure Object Oriented</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Every value is an object</span></span><br><span class="line"><span class="number">1.</span>toString</span><br><span class="line"><span class="comment">// Every operation is a method call</span></span><br><span class="line"><span class="number">1</span> + <span class="number">2</span> + <span class="number">3</span> -&gt; (<span class="number">1</span>).+(<span class="number">2</span>).+(<span class="number">3</span>)</span><br><span class="line"><span class="comment">// Can omit . and ( )</span></span><br><span class="line"><span class="string">"abc"</span> charAt <span class="number">1</span> -&gt; <span class="string">"abc"</span>.charAt(<span class="number">1</span>)</span><br><span class="line"><span class="comment">// Classes (and abstract classes) like Java </span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Language</span>(<span class="params">val name:<span class="type">String</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">toString</span> </span>= name </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Example implementations</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Scala</span> <span class="keyword">extends</span> <span class="title">Language</span>(<span class="params">"<span class="type">Scala</span>"</span>)</span></span><br><span class="line"><span class="class"><span class="title">//</span> <span class="title">Anonymous</span> <span class="title">class</span></span></span><br><span class="line"><span class="class"><span class="title">val</span> <span class="title">scala</span> </span>= <span class="keyword">new</span> <span class="type">Language</span>(<span class="string">"Scala"</span>) &#123; <span class="comment">/* empty */</span> &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Scala Traits</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Like interfaces in Java</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">JVM</span> </span>&#123;</span><br><span class="line">    <span class="comment">// But allow implementation</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">toString</span> </span>= <span class="keyword">super</span>.toString+<span class="string">" runs on JVM"</span> &#125; <span class="class"><span class="keyword">trait</span> <span class="title">Static</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">toString</span> </span>= <span class="keyword">super</span>.toString+<span class="string">" is Static"</span> &#125;</span><br><span class="line"><span class="comment">// Traits are stackable</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Scala</span> <span class="keyword">extends</span> <span class="title">Language</span> <span class="keyword">with</span> <span class="title">JVM</span> <span class="keyword">with</span>  <span class="title">Static</span> </span>&#123; </span><br><span class="line">    <span class="keyword">val</span> name = <span class="string">"Scala"</span></span><br><span class="line">&#125;</span><br><span class="line">println(<span class="keyword">new</span> <span class="type">Scala</span>) -&gt; <span class="string">"Scala runs on JVM is Static"</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Scala is Functional<br>
A function that does at least one of the following:
<ul>
<li>takes one or more functions as arguments</li>
<li>returns a function as its result</li>
</ul>
</li>
</ul>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> plusOne = (x:<span class="type">Int</span>) =&gt; x + <span class="number">1</span></span><br><span class="line"><span class="keyword">val</span> nums = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="comment">// map takes a function: Int =&gt; T </span></span><br><span class="line">nums.map(plusOne)</span><br><span class="line"><span class="comment">// List(2,3,4) </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Inline Anonymous</span></span><br><span class="line">nums.map(x =&gt; x + <span class="number">1</span>) </span><br><span class="line"><span class="comment">// List(2,3,4) </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Short form</span></span><br><span class="line">nums.map(_ + <span class="number">1</span>) </span><br><span class="line"><span class="comment">// List(2,3,4)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> nums = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line"><span class="comment">// A few more examples for List class</span></span><br><span class="line">nums.exists(_ == <span class="number">2</span>) </span><br><span class="line"><span class="comment">// true</span></span><br><span class="line">nums.find(_ == <span class="number">2</span>)</span><br><span class="line"><span class="comment">// Some(2)  </span></span><br><span class="line">nums.indexWhere(_ == <span class="number">2</span>)</span><br><span class="line"><span class="comment">// 1 (find the position)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// functions as parameters, apply f to the value “1”</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">call</span></span>(f: <span class="type">Int</span> =&gt; <span class="type">Int</span>) = f(<span class="number">1</span>)</span><br><span class="line">call(plusOne) </span><br><span class="line"><span class="comment">// 2 </span></span><br><span class="line">call(x=&gt;x+<span class="number">1</span>) </span><br><span class="line"><span class="comment">// 2 </span></span><br><span class="line">call(_ + <span class="number">1</span>) </span><br><span class="line"><span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<ul>
<li>The Usage of “_” in Scala</li>
</ul>
<ol>
<li>In anonymous functions, the “_” acts as a placeholder for parameters</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nums.map(x =&gt; x + <span class="number">1</span>)</span><br><span class="line"><span class="comment">//is equivalent to:</span></span><br><span class="line">nums.map(_ + <span class="number">1</span>)</span><br><span class="line"><span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>).foreach(print(_))</span><br><span class="line"><span class="comment">//is equivalent to:               </span></span><br><span class="line"><span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>).foreach( a =&gt; print(a) )</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>You can use two or more underscores to refer different parameters.</li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> sum = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>).reduceLeft(_+_)</span><br><span class="line">is equivalent to:</span><br><span class="line"><span class="keyword">val</span> sum = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>).reduceLeft((a, b) =&gt; a + b)</span><br></pre></td></tr></table></figure>
<h1 id="rdd-introduction">RDD Introduction</h1>
<hr>
<h2 id="why-rdd">Why RDD?</h2>
<ul>
<li>Existing Systems
<ul>
<li>Existing in-memory storage systems have interfaces based on fine-grained updates
<ul>
<li>Reads and writes to cells in a table</li>
<li>E.g., databases, key-value stores, distributed memory</li>
</ul>
</li>
<li>Requires replicating data or logs across nodes for fault tolerance -&gt; expensive!
<ul>
<li>10-100x slower than memory write</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>How to design a distributed memory abstraction that is both <strong>fault-tolerant and efficient</strong>?</p>
<h2 id="what-is-rdd">What is RDD?</h2>
<ul>
<li>
<p>RDD(Resilient Distributed Datasets):<br>
A Fault-Tolerant Abstraction for In-Memory Cluster Computing.<br>
<strong>RDD is a distributed memory abstraction that lets programmers perform in-memory computations on large clusters in a fault-tolerant manner.</strong></p>
</li>
<li>
<p><strong>Resilient</strong>(有弹性)<br>
Fault-tolerant, is able to recompute missing or damaged partitions due to node failures.</p>
</li>
<li>
<p><strong>Distributed</strong><br>
Data residing on multiple nodes in a cluster.</p>
</li>
<li>
<p><strong>Dataset</strong><br>
A collection of partitioned elements, e.g.tuples or other objects(that represent records of the data you work with).</p>
</li>
<li>
<p>RDD is the primary data abstraction in Apache Spark and the core of Spark. It enables operations on collection of elements in parallel.</p>
</li>
</ul>
<h2 id="rdd-traits">RDD Traits</h2>
<ul>
<li><strong>In-Memory</strong>, i.e. data inside RDD is stored in memory as much (size) and long (time) as possible.</li>
<li><strong>Immutable</strong>(不可改变的) or <strong>Read-Only</strong>, i.e. it does not change once created and can only be transformed using transformations to new RDDs.</li>
<li><strong>Lazy evaluated</strong>, i.e. the data inside RDD is not available or transformed until an action is executed that triggers the execution.</li>
<li><strong>Cacheable</strong>, i.e. you can hold all the data in a persistent “storage” like memory (default and the most preferred) or disk (the least preferred due to access speed).</li>
<li><strong>Parallel</strong>, i.e. process data in parallel.</li>
<li><strong>Typed</strong>, i.e. values in a RDD have types, e.g. RDD[Long] or RDD[(Int, String)].</li>
<li><strong>Partitioned</strong>, i.e. the data inside a RDD is partitioned (split into partitions) and then distributed across nodes in a cluster (one partition per JVM that may or may not correspond to a single node).</li>
</ul>
<h2 id="rdd-operations">RDD Operations</h2>
<ul>
<li><strong>Transformation</strong>: <strong>returns a new RDD.</strong>
<ul>
<li>Nothing gets evaluated when you call a Transformation function, it<br>
just takes an RDD and return a new RDD.</li>
<li>Transformation functions <strong>include map, filter, flatMap, groupByKey, reduceByKey, aggregateByKey, filter, join, etc.</strong></li>
</ul>
</li>
</ul>
<blockquote>
<ul>
<li>map: Return a new distributed dataset formed by passing each element of the source through a function func.<br>
<strong>一一映射</strong></li>
<li>flatMap: Similar to map, but each input item can be mapped to 0 or more output items (so func should return a Seq rather than a single item).<br>
<strong>先映射，再扁平化</strong></li>
</ul>
</blockquote>
<ul>
<li><strong>Action</strong>: <strong>evaluates and returns a new value.</strong>
<ul>
<li>When an Action function is called on a RDD object, all the data processing queries are computed at that time and the result value is returned.</li>
<li>Action operations <strong>include reduce, collect, count, first, take, countByKey, foreach, saveAsTextFile, etc.</strong><br>
<a href="http://homepage.cs.latrobe.edu.au/zhe/ZhenHeSparkRDDAPIExamples.html" target="_blank" rel="noopener">Spark RDD API Examples</a></li>
</ul>
</li>
</ul>
<h2 id="working-with-rdds">Working with RDDs</h2>
<ol>
<li><strong>Create an RDD</strong> from a data source
<ul>
<li>by parallelizing existing collections (lists or arrays)</li>
<li>by transforming an existing RDDs</li>
<li>from files in HDFS or any other storage system</li>
</ul>
</li>
<li><strong>Apply transformations</strong> to a RDD. E.g., Map, Filter</li>
<li><strong>Apply actions</strong> to a RDD. E.g., Collect, Count</li>
</ol>
<p><img src="7.png" alt=""></p>
<ul>
<li>Users can control two other aspects:
<ul>
<li>Persistence</li>
<li>Partitioning</li>
</ul>
</li>
</ul>
<h3 id="creating-rdds">Creating RDDs</h3>
<ul>
<li>From HDFS, text files, Amazon S3, Apache HBase, SequenceFiles, any other Hadoop InputFormat</li>
<li>Creating an RDD from a File<br>
E.g., val inputfile = sc.textFile(&quot;…&quot;, 4)
<ul>
<li>RDD distributed in 4 partitions</li>
<li>Elements are lines of input</li>
<li>Lazy evaluation means no execution happens now</li>
</ul>
</li>
<li>Turn a collection into an RDD
<ul>
<li>sc.parallelize([1, 2, 3]), creating from a Python list</li>
<li>sc.parallelize(Array(“hello”, “spark”)), creating from a Scala Array</li>
</ul>
</li>
<li>Creating an RDD from an existing Hadoop InputFormat
<ul>
<li>sc.hadoopFile(keyClass, valClass, inputFmt, conf)</li>
</ul>
</li>
</ul>
<h3 id="transformations">Transformations</h3>
<ul>
<li>Create new datasets from an existing one</li>
<li>Use lazy evaluation: results not computed right away – instead Spark remembers set of transformations applied to base dataset
<ul>
<li>Spark optimizes the required calculations</li>
<li>Spark recovers from failures</li>
</ul>
</li>
<li>Some transformation functions<br>
<img src="8.png" alt=""><br>
<a href="https://spark.apache.org/docs/latest/rdd-programming-guide.html#transformations" target="_blank" rel="noopener">Common transformations API guide</a></li>
</ul>
<h3 id="actions">Actions</h3>
<ul>
<li>Cause Spark to execute recipe to transform source</li>
<li>Mechanism for getting results out of Spark</li>
<li>Some action functions<br>
<img src="9.png" alt=""><br>
<a href="https://spark.apache.org/docs/latest/rdd-programming-guide.html#actions" target="_blank" rel="noopener">Common actions API guide</a></li>
</ul>
<p>Example</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//base RDD</span></span><br><span class="line"><span class="keyword">val</span> lines = sc.textFile(“hdfs:<span class="comment">//...”)</span></span><br><span class="line"><span class="comment">//Transformed RDD</span></span><br><span class="line"><span class="keyword">val</span> errors = lines.filter(_.startsWith(“<span class="type">Error</span>”))</span><br><span class="line">errors.persist()</span><br><span class="line"><span class="comment">//Action</span></span><br><span class="line">errors.count() </span><br><span class="line">errors.filter(_.contains(“<span class="type">HDFS</span>”))</span><br><span class="line">            .map(_.split(‘\t’(<span class="number">3</span>)) </span><br><span class="line">            .collect()</span><br></pre></td></tr></table></figure>
<h2 id="rdd-persistence-cachepersist">RDD Persistence: Cache/Persist</h2>
<ul>
<li>When you persist an RDD, each node stores any partitions of it. You can reuse it in other actions on that dataset</li>
<li>Each persisted RDD can be stored using a different storage level.
<ul>
<li>MEMORY_ONLY:
<ul>
<li>Store RDD as deserialized Java objects in the JVM.</li>
<li>If the RDD does not fit in memory, some partitions will not be cached and will be recomputed when they’re needed.</li>
<li>This is default level.</li>
</ul>
</li>
<li>MEMORY_AND_DISK:
<ul>
<li>If the RDD does not fit in memory, store the partitions that don’t fit on disk, and read them from there when they’re needed.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Example:</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> lines = sc.textFile(“hdfs:<span class="comment">//...”)</span></span><br><span class="line"><span class="keyword">val</span> errors = lines.filter(_.startsWith(“<span class="type">Error</span>”))</span><br><span class="line">errors.persist()</span><br><span class="line">errors.count()</span><br></pre></td></tr></table></figure>
<ul>
<li>If you do errors.count() again, the file will be loaded again and computed again.</li>
<li>Persist will tell Spark to cache the data in memory, to reduce the data loading cost for further actions on the same data.</li>
<li>error.persist() will do nothing. It is a lazy operation. But now the RDD says “read this file and then cache the contents”. The action will trigger computation and data caching.</li>
</ul>
<h2 id="key-value-rdds">Key-Value RDDs</h2>
<ul>
<li>Similar to Map Reduce, Spark supports Key-Value pairs</li>
<li>Each element of a Pair RDD is a pair tuple</li>
<li>Some Key-Value transformation functions:<br>
<img src="11.png" alt=""></li>
</ul>
<p>Example</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Create a pair RDD from existing RDDs</span><span class="keyword">val</span> pairs = sc.parallelize( <span class="type">List</span>( (“<span class="type">This</span>”, <span class="number">2</span>), (“is”, <span class="number">3</span>), (“<span class="type">Spark</span>”, <span class="number">5</span>), (“is”, <span class="number">3</span>) ) ) </span><br><span class="line">pairs.collect().foreach(println)</span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line">(<span class="keyword">this</span>,<span class="number">2</span>)</span><br><span class="line">(is,<span class="number">3</span>)</span><br><span class="line">(spark,<span class="number">5</span>)</span><br><span class="line">(is,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//reduceByKey() function: reduce key-value pairs by key using give func</span><span class="keyword">val</span> pair1 = pairs.reduceByKey((x,y) =&gt; x + y) </span><br><span class="line">pair1.collect().foreach(println)</span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line">(<span class="keyword">this</span>,<span class="number">2</span>)</span><br><span class="line">(spark,<span class="number">5</span>)</span><br><span class="line">(is,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//mapValues() function: work on values only</span><span class="keyword">val</span> pair2 = pairs.mapValues( x =&gt; x <span class="number">-1</span> ) pairs2.collect().foreach(println)</span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line">(<span class="keyword">this</span>,<span class="number">1</span>)</span><br><span class="line">(is,<span class="number">2</span>)</span><br><span class="line">(spark,<span class="number">4</span>)</span><br><span class="line">(is,<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//groupByKey() function: When called on a dataset of (K, V) pairs, returns a dataset of (K, Iterable&lt;V&gt;) pairs</span></span><br><span class="line">pairs.groupByKey().collect().foreach(println)</span><br><span class="line"><span class="comment">//output:</span></span><br><span class="line">(<span class="keyword">this</span>,<span class="type">CompactBuffer</span>(<span class="number">2</span>))</span><br><span class="line">(spark,<span class="type">CompactBuffer</span>(<span class="number">5</span>))</span><br><span class="line">(is,<span class="type">CompactBuffer</span>(<span class="number">3</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<h1 id="spark-programming-model">Spark Programming Model</h1>
<h2 id="how-spark-works">How Spark Works</h2>
<ul>
<li>User application create RDDs, transform them, and run actions.</li>
<li>This results in a <strong>DAG (Directed Acyclic Graph)</strong> of operators.</li>
<li>DAG is compiled into <strong>stages</strong></li>
<li>Each stage is executed as <strong>a series of Task</strong> (<strong>one Task for each Partition</strong>).</li>
</ul>
<h2 id="word-count-in-spark">Word Count in Spark</h2>
<p><img src="12.png" alt=""><img src="13.png" alt=""><img src="14.png" alt=""></p>
<h1 id="self-contained-applications">Self-Contained Applications</h1>
<p><a href="https://jingxuan.li/2018/05/28/IntelliJ-IDEA%E7%BB%93%E5%90%88SBT%E5%88%9B%E5%BB%BAScala%E9%A1%B9%E7%9B%AE/">IntelliJ IDEA结合SBT创建Scala项目</a></p>

                

                <hr>
                <!-- Pager -->
                <ul class="pager">
                    
                        <li class="previous">
                            <a href="/2018/05/05/COMP9313-Week-7-Spark-II/" data-toggle="tooltip" data-placement="top" title="Spark II">&larr; Previous Post</a>
                        </li>
                    
                    
                        <li class="next">
                            <a href="/2018/04/14/COMP9313-Week-4-MapReduce-III/" data-toggle="tooltip" data-placement="top" title="MapReduce III">Next Post &rarr;</a>
                        </li>
                    
                </ul>

                <!-- duoshuo Share start -->
                
                <!-- 多说 Share end-->

                <!-- 多说评论框 start -->
                
                <!-- 多说评论框 end -->

                <!-- disqus comment start -->
                
                    <div class="comment">
                        <div id="disqus_thread" class="disqus-thread"></div>
                    </div>
                
                <!-- disqus comment end -->
            </div>
            
            <!-- Tabe of Content -->
            <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#spark-introduction"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">Spark Introduction</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#why-spark"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">Why Spark?</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#what-is-spark"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">What is Spark?</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#data-sources"><span class="toc-nav-number">1.3.</span> <span class="toc-nav-text">Data Sources</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#spark-workflow"><span class="toc-nav-number">1.4.</span> <span class="toc-nav-text">Spark Workflow</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#worker-nodes-and-executors"><span class="toc-nav-number">1.5.</span> <span class="toc-nav-text">Worker Nodes and Executors</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#scala-introduction"><span class="toc-nav-number">2.</span> <span class="toc-nav-text">Scala Introduction</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#scala-basic-syntax"><span class="toc-nav-number">2.1.</span> <span class="toc-nav-text">Scala Basic Syntax</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#rdd-introduction"><span class="toc-nav-number">3.</span> <span class="toc-nav-text">RDD Introduction</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#why-rdd"><span class="toc-nav-number">3.1.</span> <span class="toc-nav-text">Why RDD?</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#what-is-rdd"><span class="toc-nav-number">3.2.</span> <span class="toc-nav-text">What is RDD?</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#rdd-traits"><span class="toc-nav-number">3.3.</span> <span class="toc-nav-text">RDD Traits</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#rdd-operations"><span class="toc-nav-number">3.4.</span> <span class="toc-nav-text">RDD Operations</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#working-with-rdds"><span class="toc-nav-number">3.5.</span> <span class="toc-nav-text">Working with RDDs</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#creating-rdds"><span class="toc-nav-number">3.5.1.</span> <span class="toc-nav-text">Creating RDDs</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#transformations"><span class="toc-nav-number">3.5.2.</span> <span class="toc-nav-text">Transformations</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#actions"><span class="toc-nav-number">3.5.3.</span> <span class="toc-nav-text">Actions</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#rdd-persistence-cachepersist"><span class="toc-nav-number">3.6.</span> <span class="toc-nav-text">RDD Persistence: Cache/Persist</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#key-value-rdds"><span class="toc-nav-number">3.7.</span> <span class="toc-nav-text">Key-Value RDDs</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#spark-programming-model"><span class="toc-nav-number">4.</span> <span class="toc-nav-text">Spark Programming Model</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#how-spark-works"><span class="toc-nav-number">4.1.</span> <span class="toc-nav-text">How Spark Works</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#word-count-in-spark"><span class="toc-nav-number">4.2.</span> <span class="toc-nav-text">Word Count in Spark</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#self-contained-applications"><span class="toc-nav-number">5.</span> <span class="toc-nav-text">Self-Contained Applications</span></a></li></ol>
        
        </div>
      </aside>
    

                
            <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                       
                          <a class="tag" href="/tags/#COMP9313" title="COMP9313">COMP9313</a>
                        
                          <a class="tag" href="/tags/#Spark" title="Spark">Spark</a>
                        
                          <a class="tag" href="/tags/#Scala" title="Scala">Scala</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
            </div>
        </div>
    </div>
</article>




<!-- disqus embedded js code start (one page only need to embed once) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "jingxuan-li";
    var disqus_identifier = "https://jingxuan.li/2018/05/05/COMP9313-Week-6-Spark-I/";
    var disqus_url = "https://jingxuan.li/2018/05/05/COMP9313-Week-6-Spark-I/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus embedded js code start end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'hover',
          placement: 'left',
          icon: 'ℬ'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                
                
                

                

                
                    <li>
                        <a target="_blank" href="https://www.facebook.com/jingxuan0">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank"  href="https://github.com/jaceyli">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                
                    <li>
                        <a target="_blank"  href="https://www.linkedin.com/in/jingxuan-li-490a60152/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Jingxuan 2018 
                    <br>
                    Theme by <a href="http://huangxuan.me">Hux</a> 
                    <span style="display: inline-block; margin: 0 5px;">
                    | 
                    <span id="busuanzi_container_site_pv">
                     本站总访问量<span id="busuanzi_value_site_pv"></span>次
                    </span>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js"></script>

<!-- 不蒜子统计 -->
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("https://jingxuan.li/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>

<!-- Google Analytics -->


<script>
    // dynamic User by Hux
    var _gaId = 'UA-XXXXXXXX-X';
    var _gaDomain = 'yoursite';

    // Originial
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', _gaId, _gaDomain);
    ga('send', 'pageview');
</script>




<!-- Baidu Tongji -->






	<a id="rocket" href="#top" class=""></a>
	<script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
    <script type="text/javascript" src="/js/toc.js?v=1.0.0" async=""></script>


</body>

</html>
